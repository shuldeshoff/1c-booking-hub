// ====================================================================
// Модуль конфигурации и настроек интеграции
// ====================================================================
// Назначение: Централизованное хранение настроек подключения к API
// Автор: Шульдешов Юрий Леонидович (shuldeshoff@mail.ru)
// Версия: 2.0
// ====================================================================

#Область НастройкиПодключения

// Получить настройки подключения к API
// 
// Возвращаемое значение:
//   Структура - Параметры подключения к API:
//     * URLСервера - Строка - Адрес API сервера
//     * ТаймаутСоединения - Число - Таймаут в секундах
//     * МаксимальноеКоличествоПопыток - Число - Количество повторных попыток при ошибке
//     * РазмерСтраницы - Число - Количество записей на одной странице
//
Функция ПолучитьНастройкиПодключения() Экспорт
	
	Настройки = Новый Структура;
	
	// URL API сервера (должен быть настроен администратором)
	Настройки.Вставить("URLСервера", ПолучитьURLСервера());
	
	// Параметры подключения
	Настройки.Вставить("ТаймаутСоединения", 30); // секунд
	Настройки.Вставить("МаксимальноеКоличествоПопыток", 3);
	Настройки.Вставить("РазмерСтраницы", 10);
	
	// Таймаут между попытками (в секундах)
	Настройки.Вставить("ТаймаутМеждуПопытками", 5);
	
	Возврат Настройки;
	
КонецФункции

// Получить учетные данные для API
// 
// Возвращаемое значение:
//   Структура - Учетные данные:
//     * Логин - Строка - Логин пользователя API
//     * Пароль - Строка - Пароль (из защищенного хранилища)
//
Функция ПолучитьУчетныеДанные() Экспорт
	
	УчетныеДанные = Новый Структура;
	
	// В реальном проекте данные должны храниться в:
	// 1. Регистре сведений с защищенным хранилищем
	// 2. Константах с типом "Хранилище значения"
	// 3. Внешнем хранилище ключей (например, HashiCorp Vault)
	
	// Для тестирования - заглушки
	УчетныеДанные.Вставить("Логин", ПолучитьЛогинИзНастроек());
	УчетныеДанные.Вставить("Пароль", ПолучитьПарольИзНастроек());
	
	Возврат УчетныеДанные;
	
КонецФункции

#КонецОбласти

#Область НастройкиПоставщиков

// Получить настройки поставщиков
// 
// Возвращаемое значение:
//   Соответствие - Настройки поставщиков, где:
//     * Ключ - Строка - Идентификатор поставщика в API
//     * Значение - Структура - Параметры поставщика
//
Функция ПолучитьНастройкиПоставщиков() Экспорт
	
	НастройкиПоставщиков = Новый Соответствие;
	
	// Поставщик 1: Пример системы бронирования А
	НастройкиПоставщика1 = Новый Структура;
	НастройкиПоставщика1.Вставить("ИмяВAPI", "provider-a");
	НастройкиПоставщика1.Вставить("НаименованиеКонтрагента", "ПОСТАВЩИК А ООО");
	НастройкиПоставщика1.Вставить("Договор", "№001 от 01.01.2024");
	НастройкиПоставщика1.Вставить("ФиксированнаяКомиссия", 30); // рублей
	НастройкиПоставщика1.Вставить("ТипРасчетаКомиссии", "Фиксированная");
	
	НастройкиПоставщиков.Вставить("provider-a", НастройкиПоставщика1);
	
	// Поставщик 2: Пример системы бронирования Б
	НастройкиПоставщика2 = Новый Структура;
	НастройкиПоставщика2.Вставить("ИмяВAPI", "provider-b");
	НастройкиПоставщика2.Вставить("НаименованиеКонтрагента", "ПОСТАВЩИК Б ООО");
	НастройкиПоставщика2.Вставить("Договор", "№002 от 01.02.2024");
	НастройкиПоставщика2.Вставить("ТипРасчетаКомиссии", "ПроцентОтГросс");
	
	НастройкиПоставщиков.Вставить("provider-b", НастройкиПоставщика2);
	
	Возврат НастройкиПоставщиков;
	
КонецФункции

#КонецОбласти

#Область НастройкиОрганизации

// Получить реквизиты организации
//
// Возвращаемое значение:
//   Структура - Реквизиты организации
//
Функция ПолучитьРеквизитыОрганизации() Экспорт
	
	Реквизиты = Новый Структура;
	
	Реквизиты.Вставить("Наименование", "МОЯ КОМПАНИЯ ООО");
	Реквизиты.Вставить("Подразделение", "Основное подразделение");
	Реквизиты.Вставить("БанковскийСчет", "40702810800000000000");
	Реквизиты.Вставить("Склад", "Основной склад");
	Реквизиты.Вставить("Ответственный", "Администратор");
	
	Возврат Реквизиты;
	
КонецФункции

#КонецОбласти

#Область СлужебныеФункции

// Получить URL сервера из настроек
//
// Возвращаемое значение:
//   Строка - URL API сервера
//
Функция ПолучитьURLСервера()
	
	// В продакшн: читать из регистра сведений или констант
	// Например: Константы.URLAPIСервераБронирования.Получить()
	
	Возврат "api.example.com"; // Тестовое значение
	
КонецФункции

// Получить логин из защищенного хранилища
//
// Возвращаемое значение:
//   Строка - Логин для API
//
Функция ПолучитьЛогинИзНастроек()
	
	// В продакшн: читать из защищенного хранилища
	// Пример:
	// РегистрыСведений.НастройкиИнтеграцииAPI.ПолучитьПоследнее().Логин
	
	Возврат "api_user@example.com"; // Тестовое значение
	
КонецФункции

// Получить пароль из защищенного хранилища
//
// Возвращаемое значение:
//   Строка - Пароль для API
//
Функция ПолучитьПарольИзНастроек()
	
	// В продакшн: читать из защищенного хранилища
	// НИКОГДА не хранить пароли в коде!
	// Пример:
	// РегистрыСведений.НастройкиИнтеграцииAPI.ПолучитьПоследнее().Пароль.Получить()
	
	Возврат "***ЗАЩИЩЕННОЕ_ХРАНИЛИЩЕ***"; // Тестовое значение
	
КонецФункции

#КонецОбласти

#Область НастройкиЛогирования

// Получить настройки логирования
//
// Возвращаемое значение:
//   Структура - Параметры логирования
//
Функция ПолучитьНастройкиЛогирования() Экспорт
	
	Настройки = Новый Структура;
	
	// Уровни логирования: "Отладка", "Информация", "Предупреждение", "Ошибка"
	Настройки.Вставить("УровеньЛогирования", "Информация");
	
	// Записывать ли логи в журнал регистрации
	Настройки.Вставить("ЗаписыватьВЖурналРегистрации", Истина);
	
	// Записывать ли логи в файл
	Настройки.Вставить("ЗаписыватьВФайл", Ложь);
	
	// Максимальное количество записей в памяти (для отображения в форме)
	Настройки.Вставить("МаксимальноКоличествоЗаписейВПамяти", 100);
	
	Возврат Настройки;
	
КонецФункции

#КонецОбласти

